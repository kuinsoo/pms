<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.or.ddit.message.mapper.MessageMapper">
	<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->
	<!-- 받은 쪽지 리스트 + 페이징처리 -->
	<select id="messageReceived"  resultType= "msgVo" parameterType="pageVo">
		select * from(
		    select rownum rnum ,a.*
		             from
		                  (select A.MSG_SMEMBER, 
	                              A.MSG_CONTENT, 
	                              A.MSG_TIME
	                        from  MESSAGE A, MESSAGE_MEMBER B
	                        where A.MSG_ID = B.MSGMEMBER_MSG
	                         and  B.MSG_RMEMBER= #{member_mail})a)
	 		 where rnum between ${page}*${pageSize}-(${pageSize}-1) AND ${page}*${pageSize}
	</select>
	
	<!--  받은쪽지 갯수  -->
	<select id="totalMsgReceived" resultType="int" parameterType="String">
		select count (*)
		from MESSAGE_MEMBER
		where MSG_RMEMBER = #{member_mail}
	</select>
	
	
	<select id = "selectMessageReceived" resultType="msgVo" parameterType="String">
		select A.MSG_SMEMBER, 
      		   A.MSG_CONTENT, 
      		   A.MSG_TIME
		from  MESSAGE A, MESSAGE_MEMBER B
		where A.MSG_ID = B.MSGMEMBER_MSG
 		and  B.MSG_RMEMBER= #{member_mail}
 		and  A.MSG_ID = #{msg_id}
	</select>
	<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->
	<!-- 보낸쪽지 리스트 + 페이징 처리 -->
		
	<select id="messageSend"  resultType= "msgVo" parameterType="pageVo">
		select * from(
		    select rownum rnum ,a.*
		             from
		                  (select B.MSG_RMEMBER, 
                                  A.MSG_CONTENT, 
                                  B.MSG_RDATE
                            from  MESSAGE A, MESSAGE_MEMBER B
                            where A.MSG_ID = B.MSGMEMBER_MSG
                            and A.MSG_SMEMBER = #{member_mail})a)
            where rnum between ${page}*${pageSize}-(${pageSize}-1) AND ${page}*${pageSize}
	</select>
	
	<!--  보낸쪽지 갯수  -->
	<select id="totalMsgSend" resultType="int" parameterType="String">
		select count(*) from message
        where MSG_SMEMBER = #{member_mail}
	</select>
	
	
	<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->
	
	
	
</mapper>